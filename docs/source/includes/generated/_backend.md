<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

## backend



### Constants

#### TracerName

```go
const TracerName = "go-workflow"
```



### Variables

#### ErrInstanceAlreadyExists

```go
var ErrInstanceAlreadyExists = errors.New("workflow instance already exists")
```



#### ErrInstanceNotFinished

```go
var ErrInstanceNotFinished = errors.New("workflow instance is not finished")
```



#### ErrInstanceNotFound

```go
var ErrInstanceNotFound = errors.New("workflow instance not found")
```



<a name="ActivityTask"></a>
### type ActivityTask

ActivityTask represents one activity execution.

```go
type ActivityTask struct {
    ID  string

    WorkflowInstance *core.WorkflowInstance

    Event *history.Event
}
```

<a name="Backend"></a>
### type Backend



```go
type Backend interface {
    // CreateWorkflowInstance creates a new workflow instance
    CreateWorkflowInstance(ctx context.Context, instance *workflow.Instance, event *history.Event) error

    // CancelWorkflowInstance cancels a running workflow instance
    CancelWorkflowInstance(ctx context.Context, instance *workflow.Instance, cancelEvent *history.Event) error

    // RemoveWorkflowInstance removes a workflow instance
    RemoveWorkflowInstance(ctx context.Context, instance *workflow.Instance) error

    // GetWorkflowInstanceState returns the state of the given workflow instance
    GetWorkflowInstanceState(ctx context.Context, instance *workflow.Instance) (core.WorkflowInstanceState, error)

    // GetWorkflowInstanceHistory returns the workflow history for the given instance. When lastSequenceID
    // is given, only events after that event are returned. Otherwise the full history is returned.
    GetWorkflowInstanceHistory(ctx context.Context, instance *workflow.Instance, lastSequenceID *int64) ([]*history.Event, error)

    // SignalWorkflow signals a running workflow instance
    //
    // If the given instance does not exist, it will return an error
    SignalWorkflow(ctx context.Context, instanceID string, event *history.Event) error

    // GetWorkflowTask returns a pending workflow task or nil if there are no pending workflow executions
    GetWorkflowTask(ctx context.Context) (*WorkflowTask, error)

    // ExtendWorkflowTask extends the lock of a workflow task
    ExtendWorkflowTask(ctx context.Context, taskID string, instance *core.WorkflowInstance) error

    // CompleteWorkflowTask checkpoints a workflow task retrieved using GetWorkflowTask
    //
    // This checkpoints the execution. events are new events from the last workflow execution
    // which will be added to the workflow instance history. workflowEvents are new events for the
    // completed or other workflow instances.
    CompleteWorkflowTask(
        ctx context.Context, task *WorkflowTask, instance *workflow.Instance, state core.WorkflowInstanceState,
        executedEvents, activityEvents, timerEvents []*history.Event, workflowEvents []history.WorkflowEvent) error

    // GetActivityTask returns a pending activity task or nil if there are no pending activities
    GetActivityTask(ctx context.Context) (*ActivityTask, error)

    // CompleteActivityTask completes an activity task retrieved using GetActivityTask
    CompleteActivityTask(ctx context.Context, instance *workflow.Instance, activityID string, event *history.Event) error

    // ExtendActivityTask extends the lock of an activity task
    ExtendActivityTask(ctx context.Context, activityID string) error

    // GetStats returns stats about the backend
    GetStats(ctx context.Context) (*Stats, error)

    // Logger returns the configured logger for the backend
    Logger() *slog.Logger

    // Tracer returns the configured trace provider for the backend
    Tracer() trace.Tracer

    // Metrics returns the configured metrics client for the backend
    Metrics() metrics.Client

    // Converter returns the configured converter for the backend
    Converter() converter.Converter

    // ContextPropagators returns the configured context propagators for the backend
    ContextPropagators() []workflow.ContextPropagator

    // Close closes any underlying resources
    Close() error
}
```

<a name="BackendOption"></a>
### type BackendOption



```go
type BackendOption func(*Options)
```

<a name="WithContextPropagator"></a>
#### func WithContextPropagator

```go
func WithContextPropagator(prop workflow.ContextPropagator) BackendOption
```



<a name="WithConverter"></a>
#### func WithConverter

```go
func WithConverter(converter converter.Converter) BackendOption
```



<a name="WithLogger"></a>
#### func WithLogger

```go
func WithLogger(logger *slog.Logger) BackendOption
```



<a name="WithMetrics"></a>
#### func WithMetrics

```go
func WithMetrics(client metrics.Client) BackendOption
```



<a name="WithStickyTimeout"></a>
#### func WithStickyTimeout

```go
func WithStickyTimeout(timeout time.Duration) BackendOption
```



<a name="WithTracerProvider"></a>
#### func WithTracerProvider

```go
func WithTracerProvider(tp trace.TracerProvider) BackendOption
```



<a name="MockBackend"></a>
### type MockBackend

MockBackend is an autogenerated mock type for the Backend type

```go
type MockBackend struct {
    mock.Mock
}
```

<a name="NewMockBackend"></a>
#### func NewMockBackend

```go
func NewMockBackend(t mockConstructorTestingTNewMockBackend) *MockBackend
```

NewMockBackend creates a new instance of MockBackend. It also registers a testing interface on the mock and a cleanup function to assert the mocks expectations.

<a name="MockBackend.CancelWorkflowInstance"></a>
#### func \(\*MockBackend\) CancelWorkflowInstance

```go
func (_m *MockBackend) CancelWorkflowInstance(ctx context.Context, instance *core.WorkflowInstance, cancelEvent *history.Event) error
```

CancelWorkflowInstance provides a mock function with given fields: ctx, instance, cancelEvent

<a name="MockBackend.Close"></a>
#### func \(\*MockBackend\) Close

```go
func (_m *MockBackend) Close() error
```

Close provides a mock function with given fields:

<a name="MockBackend.CompleteActivityTask"></a>
#### func \(\*MockBackend\) CompleteActivityTask

```go
func (_m *MockBackend) CompleteActivityTask(ctx context.Context, instance *core.WorkflowInstance, activityID string, event *history.Event) error
```

CompleteActivityTask provides a mock function with given fields: ctx, instance, activityID, event

<a name="MockBackend.CompleteWorkflowTask"></a>
#### func \(\*MockBackend\) CompleteWorkflowTask

```go
func (_m *MockBackend) CompleteWorkflowTask(ctx context.Context, task *WorkflowTask, instance *core.WorkflowInstance, state core.WorkflowInstanceState, executedEvents []*history.Event, activityEvents []*history.Event, timerEvents []*history.Event, workflowEvents []history.WorkflowEvent) error
```

CompleteWorkflowTask provides a mock function with given fields: ctx, task, instance, state, executedEvents, activityEvents, timerEvents, workflowEvents

<a name="MockBackend.ContextPropagators"></a>
#### func \(\*MockBackend\) ContextPropagators

```go
func (_m *MockBackend) ContextPropagators() []workflow.ContextPropagator
```

ContextPropagators provides a mock function with given fields:

<a name="MockBackend.Converter"></a>
#### func \(\*MockBackend\) Converter

```go
func (_m *MockBackend) Converter() converter.Converter
```

Converter provides a mock function with given fields:

<a name="MockBackend.CreateWorkflowInstance"></a>
#### func \(\*MockBackend\) CreateWorkflowInstance

```go
func (_m *MockBackend) CreateWorkflowInstance(ctx context.Context, instance *core.WorkflowInstance, event *history.Event) error
```

CreateWorkflowInstance provides a mock function with given fields: ctx, instance, event

<a name="MockBackend.ExtendActivityTask"></a>
#### func \(\*MockBackend\) ExtendActivityTask

```go
func (_m *MockBackend) ExtendActivityTask(ctx context.Context, activityID string) error
```

ExtendActivityTask provides a mock function with given fields: ctx, activityID

<a name="MockBackend.ExtendWorkflowTask"></a>
#### func \(\*MockBackend\) ExtendWorkflowTask

```go
func (_m *MockBackend) ExtendWorkflowTask(ctx context.Context, taskID string, instance *core.WorkflowInstance) error
```

ExtendWorkflowTask provides a mock function with given fields: ctx, taskID, instance

<a name="MockBackend.GetActivityTask"></a>
#### func \(\*MockBackend\) GetActivityTask

```go
func (_m *MockBackend) GetActivityTask(ctx context.Context) (*ActivityTask, error)
```

GetActivityTask provides a mock function with given fields: ctx

<a name="MockBackend.GetStats"></a>
#### func \(\*MockBackend\) GetStats

```go
func (_m *MockBackend) GetStats(ctx context.Context) (*Stats, error)
```

GetStats provides a mock function with given fields: ctx

<a name="MockBackend.GetWorkflowInstanceHistory"></a>
#### func \(\*MockBackend\) GetWorkflowInstanceHistory

```go
func (_m *MockBackend) GetWorkflowInstanceHistory(ctx context.Context, instance *core.WorkflowInstance, lastSequenceID *int64) ([]*history.Event, error)
```

GetWorkflowInstanceHistory provides a mock function with given fields: ctx, instance, lastSequenceID

<a name="MockBackend.GetWorkflowInstanceState"></a>
#### func \(\*MockBackend\) GetWorkflowInstanceState

```go
func (_m *MockBackend) GetWorkflowInstanceState(ctx context.Context, instance *core.WorkflowInstance) (core.WorkflowInstanceState, error)
```

GetWorkflowInstanceState provides a mock function with given fields: ctx, instance

<a name="MockBackend.GetWorkflowTask"></a>
#### func \(\*MockBackend\) GetWorkflowTask

```go
func (_m *MockBackend) GetWorkflowTask(ctx context.Context) (*WorkflowTask, error)
```

GetWorkflowTask provides a mock function with given fields: ctx

<a name="MockBackend.Logger"></a>
#### func \(\*MockBackend\) Logger

```go
func (_m *MockBackend) Logger() *slog.Logger
```

Logger provides a mock function with given fields:

<a name="MockBackend.Metrics"></a>
#### func \(\*MockBackend\) Metrics

```go
func (_m *MockBackend) Metrics() metrics.Client
```

Metrics provides a mock function with given fields:

<a name="MockBackend.RemoveWorkflowInstance"></a>
#### func \(\*MockBackend\) RemoveWorkflowInstance

```go
func (_m *MockBackend) RemoveWorkflowInstance(ctx context.Context, instance *core.WorkflowInstance) error
```

RemoveWorkflowInstance provides a mock function with given fields: ctx, instance

<a name="MockBackend.SignalWorkflow"></a>
#### func \(\*MockBackend\) SignalWorkflow

```go
func (_m *MockBackend) SignalWorkflow(ctx context.Context, instanceID string, event *history.Event) error
```

SignalWorkflow provides a mock function with given fields: ctx, instanceID, event

<a name="MockBackend.Tracer"></a>
#### func \(\*MockBackend\) Tracer

```go
func (_m *MockBackend) Tracer() trace.Tracer
```

Tracer provides a mock function with given fields:

<a name="Options"></a>
### type Options



```go
type Options struct {
    Logger *slog.Logger

    Metrics metrics.Client

    TracerProvider trace.TracerProvider

    // Converter is the converter to use for serializing and deserializing inputs and results. If not explicitly set
    // converter.DefaultConverter is used.
    Converter converter.Converter

    // ContextPropagators is a list of context propagators to use for passing context into workflows and activities.
    ContextPropagators []workflow.ContextPropagator

    StickyTimeout time.Duration

    // WorkflowLockTimeout determines how long a workflow task can be locked for. If the workflow task is not completed
    // by that timeframe, it's considered abandoned and another worker might pick it up.
    //
    // For long running workflow tasks, combine this with heartbearts.
    WorkflowLockTimeout time.Duration

    // ActivityLockTimeout determines how long an activity task can be locked for. If the activity task is not completed
    // by that timeframe, it's considered abandoned and another worker might pick it up
    ActivityLockTimeout time.Duration
}
```

##### DefaultOptions

```go
var DefaultOptions Options = Options{
    StickyTimeout:       30 * time.Second,
    WorkflowLockTimeout: time.Minute,
    ActivityLockTimeout: time.Minute * 2,

    Logger:         slog.Default(),
    Metrics:        mi.NewNoopMetricsClient(),
    TracerProvider: trace.NewNoopTracerProvider(),
    Converter:      converter.DefaultConverter,

    ContextPropagators: []workflow.ContextPropagator{&tracing.TracingContextPropagator{}},
}
```



<a name="ApplyOptions"></a>
#### func ApplyOptions

```go
func ApplyOptions(opts ...BackendOption) Options
```



<a name="Stats"></a>
### type Stats



```go
type Stats struct {
    ActiveWorkflowInstances int64

    // PendingWorkflowTasks are the number of workflow tasks that are currently in the queue,
    // waiting to be processed by a worker
    PendingWorkflowTasks int64

    // PendingActivities are the number of activities that are currently in the queue,
    // waiting to be processed by a worker
    PendingActivities int64
}
```

<a name="WorkflowTask"></a>
### type WorkflowTask

WorkflowTask represents work for one workflow execution slice.

```go
type WorkflowTask struct {
    // ID is an identifier for this task. It's set by the backend
    ID  string

    // WorkflowInstance is the workflow instance that this task is for
    WorkflowInstance *core.WorkflowInstance

    WorkflowInstanceState core.WorkflowInstanceState

    Metadata *metadata.WorkflowMetadata

    // LastSequenceID is the sequence ID of the newest event in the workflow instances's history
    LastSequenceID int64

    // NewEvents are new events since the last task execution
    NewEvents []*history.Event

    // Backend specific data, only the producer of the task should rely on this.
    CustomData any
}
```



<!-- gomarkdoc:embed:end -->